/* frontend/src/components/LobbyView.css */
/* Responsive Lobby Design with Intentional Device-Specific Layouts */

/* =====================================================
   ROOT VARIABLES & SCALING SYSTEM
   ===================================================== */
:root {
  /* Dynamic scaling factors */
  --vh: 1vh; /* Will be updated by JS for mobile browser compatibility */
  
  /* Device-specific scales */
  --scale-mobile: 1;
  --scale-tablet: 1.2;
  --scale-desktop: 1.5;
  
  /* Base measurements that scale */
  --base-padding: 1vh;
  --base-gap: 1.5vh;
  --base-radius: 0.8vh;
  
  /* Touch target sizes */
  --touch-target-mobile: 6vh; /* ~44px minimum */
  --touch-target-tablet: 5vh;
  --touch-target-desktop: 4vh;
  
  /* Z-index system */
  --z-header: 1400;
  --z-nav: 1300;
  --z-chat: 1000;
  --z-menu: 1500;
  --z-modal: 2000;
}

/* =====================================================
   BASE LAYOUT - Mobile First Approach
   ===================================================== */
.lobby-view {
  display: flex;
  flex-direction: column;
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height for mobile browsers */
  background-color: #212121;
  color: white;
  overflow: hidden;
  position: relative;
}

/* =====================================================
   HEADER - Responsive across all devices
   ===================================================== */
.lobby-header {
  height: 6vh;
  min-height: 44px; /* Ensure minimum touch target */
  padding: 0 3vw;
  background-color: #1a1a1a;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-shrink: 0;
  box-shadow: 0 2px 4px rgba(0,0,0,0.3);
  z-index: var(--z-header);
  position: relative;
}

.header-left {
  display: flex;
  align-items: center;
  gap: 2vw;
  min-width: 0; /* Allow shrinking */
}

.header-right {
  display: flex;
  align-items: center;
  gap: 2vw;
  min-width: 0; /* Allow shrinking */
}

.lobby-logo {
  height: 4vh;
  min-height: 30px;
  max-height: 50px;
  width: auto;
}

.user-welcome {
  font-size: clamp(0.7rem, 1.8vh, 1rem);
  color: #ccc;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  /* Hide on very small screens */
  display: none;
}

.user-tokens {
  display: flex;
  align-items: center;
  gap: 0.8vh;
  font-weight: bold;
  font-family: 'Oswald', sans-serif;
  background-color: #2c2c2c;
  padding: 0.8vh 1.5vh;
  border-radius: 3vh;
  border: 1px solid #444;
  color: #eaeaea;
  cursor: pointer;
  transition: transform 0.1s ease, box-shadow 0.2s ease;
  min-height: var(--touch-target-mobile);
  min-width: var(--touch-target-mobile);
  justify-content: center;
}

.user-tokens:hover {
  background-color: #353535;
  box-shadow: 0 0 0 2px rgba(13, 110, 253, 0.25);
}

.user-tokens:active {
  transform: scale(0.98);
}

/* Pulse animation for mercy token eligibility */
@keyframes pulseGlow {
  0% { box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.45); }
  70% { box-shadow: 0 0 0 1vh rgba(255, 193, 7, 0); }
  100% { box-shadow: 0 0 0 0 rgba(255, 193, 7, 0); }
}

.user-tokens.pulse-eligible {
  animation: pulseGlow 1.6s ease-out infinite;
  border-color: #ffc107;
}

.token-icon {
  height: 2.5vh;
  min-height: 18px;
  max-height: 30px;
}

.user-tokens span {
  color: #ffc107;
  font-size: clamp(0.9rem, 2vh, 1.2rem);
}

.hamburger-menu-container {
  position: relative;
}

.hamburger-btn {
  background: none;
  border: none;
  padding: 1vh;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: var(--touch-target-mobile);
  min-height: var(--touch-target-mobile);
}

.hamburger-btn svg {
  fill: #aaa;
  width: 3vh;
  height: 3vh;
  min-width: 24px;
  min-height: 24px;
}

/* =====================================================
   NAVIGATION TABS - Horizontal scrolling on mobile
   ===================================================== */
.lobby-nav {
  display: flex;
  background-color: #2a2a2a;
  flex-shrink: 0;
  border-bottom: 1px solid #111;
  overflow-x: auto;
  overflow-y: hidden;
  height: 5vh;
  min-height: 40px;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE/Edge */
  position: relative;
  z-index: var(--z-nav);
}

.lobby-nav::-webkit-scrollbar {
  display: none; /* Chrome/Safari/Opera */
}

.lobby-tab {
  flex: 0 0 auto;
  padding: 1vh 3vw;
  border: none;
  background: transparent;
  border-bottom: 0.4vh solid transparent;
  font-family: 'Oswald', sans-serif;
  cursor: pointer;
  color: #aaa;
  white-space: nowrap;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-width: var(--touch-target-mobile);
  transition: background-color 0.2s, color 0.2s;
}

.lobby-tab:hover {
  background-color: rgba(255,255,255,0.05);
}

.lobby-tab.active {
  color: white;
  border-bottom-color: #0d6efd;
  background-color: rgba(13, 110, 253, 0.1);
}

.lobby-tab-name {
  font-size: clamp(0.8rem, 1.8vh, 1.1rem);
  font-weight: 500;
}

.lobby-tab-cost {
  display: flex;
  align-items: center;
  gap: 0.5vh;
  opacity: 0.7;
  font-size: clamp(0.7rem, 1.4vh, 0.9rem);
  margin-top: 0.2vh;
}

.tab-token-icon {
  height: 1.2vh;
  width: 1.2vh;
  min-height: 10px;
  min-width: 10px;
}

/* =====================================================
   MAIN CONTENT AREA - Mobile Layout (Default)
   ===================================================== */
.lobby-main {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 2vh 3vw;
  /* Account for fixed chat at bottom on mobile */
  padding-bottom: 27vh;
  min-height: 0; /* Allow flexbox shrinking */
  -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
}

/* Collapsible Section Toggles */
.tables-toggle,
.bulletin-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1.5vh 2vw;
  background: #1f1f1f;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: var(--base-radius);
  margin-bottom: 1vh;
  cursor: pointer;
  user-select: none;
  min-height: var(--touch-target-mobile);
  transition: background-color 0.2s;
}

.tables-toggle:hover,
.bulletin-toggle:hover {
  background-color: #252525;
}

.tables-toggle:focus,
.bulletin-toggle:focus {
  outline: 2px solid #4c9ffe;
  outline-offset: 2px;
}

.toggle-title {
  font-weight: 600;
  font-size: clamp(0.9rem, 2vh, 1.2rem);
  letter-spacing: 0.02em;
}

.toggle-caret {
  font-size: clamp(0.8rem, 1.8vh, 1rem);
  opacity: 0.7;
  transition: transform 0.2s;
}

/* Tables Section */
.tables-section {
  margin-bottom: 3vh;
}

.table-grid {
  display: grid;
  grid-template-columns: 1fr; /* Single column on mobile */
  gap: 2vh;
  width: 100%;
  box-sizing: border-box;
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(1vh); }
  to { opacity: 1; transform: translateY(0); }
}

/* Bulletin Section */
.bulletin-section {
  margin-bottom: 3vh;
}

#bulletin-content {
  padding: 2vh;
  background: #1f1f1f;
  border-radius: var(--base-radius);
  animation: fadeIn 0.3s ease;
}

/* =====================================================
   CHAT COMPONENT - Mobile Bottom Layout (Default)
   ===================================================== */
.lobby-chat-container {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 25vh;
  min-height: 180px;
  background-color: #1a1a1a;
  border-top: 1px solid #444;
  display: flex;
  flex-direction: column;
  z-index: var(--z-chat);
  transform: translateY(0);
  transition: transform 0.3s ease;
}

/* Chat minimized state for mobile */
.lobby-chat-container.minimized {
  transform: translateY(calc(25vh - 5vh));
}

.chat-header {
  height: 5vh;
  min-height: 40px;
  padding: 0 3vw;
  background-color: #222;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-shrink: 0;
  cursor: pointer;
}

.chat-title {
  font-weight: 600;
  font-size: clamp(0.9rem, 1.8vh, 1.1rem);
}

.chat-minimize-btn {
  background: none;
  border: none;
  color: #aaa;
  cursor: pointer;
  padding: 1vh;
}

/* =====================================================
   MENU POPUP - Responsive positioning
   ===================================================== */
.lobby-menu-popup {
  position: absolute;
  top: calc(100% + 1vh);
  right: 0;
  background-color: #212121;
  border: 1px solid #555;
  border-radius: var(--base-radius);
  padding: 1.5vh;
  z-index: var(--z-menu);
  box-shadow: 0 4px 12px rgba(0,0,0,0.5);
  min-width: 200px;
  max-width: 90vw;
  display: flex;
  flex-direction: column;
  gap: 0.8vh;
  animation: slideDown 0.2s ease;
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-1vh); }
  to { opacity: 1; transform: translateY(0); }
}

.lobby-menu-button {
  width: 100%;
  padding: 1.2vh 2vh;
  text-align: left;
  background-color: #333;
  color: #e0e0e0;
  border: 1px solid #444;
  border-radius: calc(var(--base-radius) * 0.5);
  font-family: 'Oswald', sans-serif;
  font-size: clamp(0.9rem, 1.8vh, 1.1rem);
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  min-height: var(--touch-target-mobile);
}

.lobby-menu-button:hover {
  background-color: #444;
  transform: translateX(0.5vh);
}

.lobby-menu-button:active {
  transform: translateX(0.5vh) scale(0.98);
}

.lobby-menu-button.admin {
  background-color: #a02c2c;
  border-color: #c82333;
}

.lobby-menu-button.admin:hover {
  background-color: #c82333;
}

.lobby-menu-button.logout {
  background-color: #5a6268;
  border-color: #6c757d;
}

.lobby-menu-button.logout:hover {
  background-color: #6c757d;
}

/* =====================================================
   FOOTER - Minimal on mobile
   ===================================================== */
.lobby-footer {
  padding: 1vh 3vw;
  background-color: #1a1a1a;
  border-top: 1px solid #444;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(0.7rem, 1.4vh, 0.9rem);
  color: #888;
  flex-shrink: 0;
  /* Hidden on mobile to save space */
  display: none;
}

/* =====================================================
   TABLET LAYOUT - 768px to 1023px
   ===================================================== */
@media (min-width: 768px) and (max-width: 1023px) {
  /* Header adjustments for tablet */
  .lobby-header {
    height: 7vh;
    padding: 0 4vw;
  }
  
  .user-welcome {
    display: block; /* Show username on tablet */
  }
  
  .lobby-logo {
    height: 5vh;
    max-height: 60px;
  }
  
  /* Navigation adjustments */
  .lobby-nav {
    height: 6vh;
    overflow-x: visible; /* No scroll needed on tablet */
    justify-content: center;
  }
  
  .lobby-tab {
    padding: 1.5vh 4vw;
    min-width: auto;
    flex: 1;
    max-width: 200px;
  }
  
  /* Main content - two column layout */
  .lobby-main {
    display: grid;
    grid-template-columns: 1fr 350px;
    gap: 3vh;
    padding: 3vh 4vw;
    padding-bottom: 3vh; /* No fixed chat on tablet */
  }
  
  .tables-section {
    grid-column: 1;
  }
  
  .bulletin-section {
    grid-column: 1;
  }
  
  /* Two-column table grid on tablet */
  .table-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 2.5vh;
  }
  
  /* Chat as sidebar on tablet */
  .lobby-chat-container {
    position: static;
    grid-column: 2;
    grid-row: 1 / -1;
    height: auto;
    min-height: 400px;
    border-left: 1px solid #444;
    border-top: none;
    border-radius: var(--base-radius);
    background-color: #1f1f1f;
  }
  
  .lobby-chat-container.minimized {
    transform: none; /* No minimize on tablet */
  }
  
  .chat-header {
    border-radius: var(--base-radius) var(--base-radius) 0 0;
  }
  
  /* Show footer on tablet */
  .lobby-footer {
    display: flex;
    height: 4vh;
    min-height: 30px;
  }
  
  /* Touch targets for tablet */
  .user-tokens,
  .hamburger-btn,
  .lobby-menu-button {
    min-height: var(--touch-target-tablet);
    min-width: var(--touch-target-tablet);
  }
}

/* =====================================================
   DESKTOP LAYOUT - 1024px and up
   ===================================================== */
@media (min-width: 1024px) {
  .lobby-view {
    max-width: 1920px;
    margin: 0 auto;
  }
  
  /* Header adjustments for desktop */
  .lobby-header {
    height: 70px;
    padding: 0 30px;
  }
  
  .header-left,
  .header-right {
    gap: 30px;
  }
  
  .user-welcome {
    display: block;
    font-size: 1rem;
  }
  
  .lobby-logo {
    height: 50px;
    max-height: none;
  }
  
  .user-tokens {
    padding: 10px 20px;
    border-radius: 25px;
    min-height: auto;
    min-width: auto;
  }
  
  .token-icon {
    height: 24px;
    max-height: none;
  }
  
  .user-tokens span {
    font-size: 1.1rem;
  }
  
  .hamburger-btn {
    padding: 10px;
    min-width: auto;
    min-height: auto;
  }
  
  .hamburger-btn svg {
    width: 28px;
    height: 28px;
  }
  
  /* Navigation for desktop */
  .lobby-nav {
    height: 50px;
    justify-content: flex-start;
    padding: 0 30px;
  }
  
  .lobby-tab {
    padding: 0 25px;
    height: 100%;
    flex: 0 0 auto;
    border-bottom-width: 4px;
    min-width: auto;
    flex-direction: row;
    gap: 15px;
  }
  
  .lobby-tab-name {
    font-size: 1.1rem;
  }
  
  .lobby-tab-cost {
    font-size: 0.9rem;
    margin-top: 0;
  }
  
  .tab-token-icon {
    height: 14px;
    width: 14px;
  }
  
  /* Three-column desktop layout */
  .lobby-main {
    display: grid;
    grid-template-columns: 300px 1fr 400px;
    grid-template-rows: auto 1fr;
    gap: 30px;
    padding: 30px;
    padding-bottom: 30px;
    height: calc(100vh - 120px - 40px); /* Header + Nav + Footer */
  }
  
  /* Desktop sidebar (new) */
  .desktop-sidebar {
    grid-column: 1;
    grid-row: 1 / -1;
    background-color: #1a1a1a;
    border-radius: 8px;
    padding: 20px;
    overflow-y: auto;
  }
  
  .sidebar-section {
    margin-bottom: 25px;
  }
  
  .sidebar-section h3 {
    font-size: 1.2rem;
    margin-bottom: 15px;
    color: #ccc;
    font-weight: 500;
  }
  
  /* Quick stats card */
  .user-stats-card {
    background: #2a2a2a;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
  }
  
  .stat-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-size: 0.95rem;
  }
  
  .stat-row:last-child {
    margin-bottom: 0;
  }
  
  .stat-label {
    color: #888;
  }
  
  .stat-value {
    color: #fff;
    font-weight: 600;
  }
  
  /* Quick actions */
  .quick-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  
  .quick-action-btn {
    padding: 12px;
    background: #333;
    border: 1px solid #444;
    border-radius: 6px;
    color: #e0e0e0;
    font-family: 'Oswald', sans-serif;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.1s;
    text-align: left;
    font-size: 1rem;
  }
  
  .quick-action-btn:hover {
    background-color: #444;
    transform: translateX(5px);
  }
  
  .quick-action-btn.admin {
    background-color: #a02c2c;
    border-color: #c82333;
  }
  
  .quick-action-btn.admin:hover {
    background-color: #c82333;
  }
  
  .quick-action-btn.logout {
    background-color: #5a6268;
    border-color: #6c757d;
  }
  
  .quick-action-btn.logout:hover {
    background-color: #6c757d;
  }
  
  /* Keyboard shortcut hints */
  .keyboard-shortcut {
    float: right;
    opacity: 0.5;
    font-size: 0.85rem;
    font-family: monospace;
  }
  
  /* Main content area */
  .tables-section {
    grid-column: 2;
    grid-row: 1 / -1;
  }
  
  .bulletin-section {
    grid-column: 3;
    grid-row: 1;
    max-height: 300px;
    overflow-y: auto;
  }
  
  /* Responsive table grid for desktop */
  .table-grid {
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
  }
  
  /* Chat on desktop */
  .lobby-chat-container {
    grid-column: 3;
    grid-row: 2;
    position: static;
    height: auto;
    min-height: 400px;
    background-color: #1a1a1a;
    border-radius: 8px;
    border: none;
  }
  
  .chat-header {
    border-radius: 8px 8px 0 0;
    cursor: default;
  }
  
  .chat-minimize-btn {
    display: none; /* No minimize on desktop */
  }
  
  /* Enhanced toggles for desktop */
  .tables-toggle,
  .bulletin-toggle {
    padding: 15px 20px;
    margin-bottom: 15px;
    border-radius: 8px;
    min-height: auto;
  }
  
  .toggle-title {
    font-size: 1.2rem;
  }
  
  .toggle-caret {
    font-size: 1rem;
  }
  
  /* Menu popup positioning */
  .lobby-menu-popup {
    top: calc(100% + 10px);
    padding: 15px;
    min-width: 250px;
    gap: 8px;
  }
  
  .lobby-menu-button {
    padding: 12px 16px;
    font-size: 1rem;
    min-height: auto;
    border-radius: 6px;
  }
  
  /* Footer visible on desktop */
  .lobby-footer {
    display: flex;
    height: 40px;
    padding: 0 30px;
    font-size: 0.9rem;
  }
  
  /* Hover effects for desktop */
  .lobby-tab:hover:not(.active) {
    background-color: rgba(255,255,255,0.05);
    color: #ddd;
  }
  
  /* Focus states for keyboard navigation */
  .lobby-tab:focus,
  .quick-action-btn:focus,
  .lobby-menu-button:focus {
    outline: 2px solid #0d6efd;
    outline-offset: 2px;
  }
}

/* =====================================================
   PORTRAIT TABLET OVERRIDE
   ===================================================== */
@media (min-width: 768px) and (orientation: portrait) {
  .lobby-main {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto 1fr;
  }
  
  .tables-section {
    grid-column: 1;
    grid-row: 2;
  }
  
  .bulletin-section {
    grid-column: 1;
    grid-row: 1;
  }
  
  .lobby-chat-container {
    grid-column: 1;
    grid-row: 3;
    border-left: none;
    border-top: 1px solid #444;
    margin-top: 2vh;
  }
  
  .table-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* =====================================================
   ULTRA-WIDE SUPPORT (1920px+)
   ===================================================== */
@media (min-width: 1920px) {
  .lobby-main {
    grid-template-columns: 350px 1fr 450px;
    gap: 40px;
    padding: 40px;
  }
  
  .table-grid {
    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
    gap: 25px;
  }
  
  .desktop-sidebar {
    padding: 25px;
  }
  
  .user-stats-card {
    padding: 20px;
    font-size: 1.05rem;
  }
  
  .quick-action-btn {
    padding: 14px 18px;
    font-size: 1.05rem;
  }
}

/* =====================================================
   UTILITY CLASSES & ANIMATIONS
   ===================================================== */
.loading-text {
  text-align: center;
  color: #888;
  padding: 4vh;
  font-size: clamp(0.9rem, 2vh, 1.1rem);
}

.error-message {
  background-color: rgba(220, 53, 69, 0.1);
  border: 1px solid #dc3545;
  color: #f8d7da;
  padding: 1.5vh 3vw;
  border-radius: var(--base-radius);
  margin: 2vh 3vw;
  font-size: clamp(0.85rem, 1.8vh, 1rem);
  animation: slideDown 0.3s ease;
}

/* Smooth transitions for layout changes */
* {
  transition-property: none;
}

@media (prefers-reduced-motion: no-preference) {
  .lobby-view * {
    transition-property: transform, opacity, background-color;
    transition-duration: 0.2s;
    transition-timing-function: ease-out;
  }
  
  .table-grid,
  .lobby-main {
    transition: grid-template-columns 0.4s ease;
  }
}

/* Accessibility improvements */
@media (prefers-contrast: high) {
  .lobby-header,
  .lobby-nav,
  .lobby-footer {
    border: 1px solid white;
  }
  
  .lobby-tab.active {
    background-color: #0d6efd;
    color: white;
  }
}

/* Print styles */
@media print {
  .lobby-chat-container,
  .hamburger-menu-container,
  .lobby-footer {
    display: none;
  }
  
  .lobby-main {
    padding-bottom: 0;
  }
}